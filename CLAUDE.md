# Claude Code Configuration for AI-Only Development

## 必須実行事項（YOU MUST）
- 全てのTODO完了またはユーザーのアクションが必要な際は最後に一度だけ `afplay /System/Library/Sounds/Sosumi.aiff` コマンドを実行して通知する
- 回答は日本語で行ってください
- TODOには必ずブランチ作成・実装内容のテスト・コミット・push・PR作成（まだ作成されていない場合）が含まれるべきです

## 技術スタック・構成

### フロントエンド
- Next.js - React基盤のフルスタックフレームワーク
- React - UI構築ライブラリ
- Tailwind CSS - ユーティリティファーストCSSフレームワーク（bolt.newのデフォルト）
- TypeScript - 型安全性を提供するJavaScriptの拡張

### バックエンド
- FastAPI (Python) - 軽量・高速なAPIフレームワーク
- Node.js - Next.jsのサーバーサイド処理用

### データベース
- PostgreSQL - リレーショナルデータベース
- SQLite - 開発・テスト用軽量データベース

### 開発環境・ツール
- Claude Code - AIによるコーディング支援ツール（月額20ドル）
- Gemini CLI - 無料のコマンドライン AI ツール
- bolt.new - AI によるUI生成ツール

### インフラ・デプロイメント
- Terraform - Infrastructure as Code（AWS環境構築）
- Docker - コンテナ化技術
- GitHub Actions - CI/CDパイプライン
- Vercel - Next.jsアプリケーションのホスティング

### ターミナル・シェル環境
- iTerm2 - 高機能ターミナルエミュレータ（macOS）
- tmux - ターミナルマルチプレクサ（並列実行）
- Zsh - 高機能シェル（Bashより拡張性あり）

### バージョン管理
- Git - 分散バージョン管理システム
- GitHub - コード管理・協業プラットフォーム  
- GitHub CLI (gh) - GitHub公式コマンドラインツール

### クラウドサービス・コスト管理
- AWS - Amazon Web Services（主要インフラプロバイダー）
- Terraform によるコード化されたインフラ管理
- **重要**: AWS月額利用料金は3000円以内に収めることを最優先とし、コスト効率を重視した構成を選択する
- 不要なリソースは自動削除、最小限のインスタンスサイズを使用

### パッケージ管理
- Poetry - Python依存関係管理
- npm/yarn - Node.js パッケージ管理

## Repository 設定
- **リポジトリ名**: [プロジェクト名を設定]
- **MCP GitHub API**: 常に指定リポジトリを使用
- **Git remote**: [リモートURL を設定]

## アプリケーションポート設定
以下のポートで各サービスが動作します：

### 開発環境（Docker Compose）
- 以下のポート番号を勝手に変更することは絶対にあってはなりません。
- **フロントエンド**: `http://localhost:3000` (ポート: 3000)
- **バックエンドAPI**: `http://localhost:8000` (ポート: 8000)

## issue作成時の注意事項
issue作成時の注意事項をai-rules/ISSUE_GUIDELINES.mdにまとめています
issue作成時は必ず確認して必ずこの内容に従ってissue作成を行ってください。

## 関数・エンドポイント作成時の注意事項
- 命名規則などを@ai-rules/API_FUNCTION_NAMING.mdにまとめています
- 関数やエンドポイントの作成時には必ず確認し、内容に従って実装を行ってください。

## 修正機能追加の際の作業開始時・終了時に必ず実施すること
- 以下の操作は作業開始時に必ず行ってください
  - **作業開始時**: 必ず専用ブランチを作成する（feat-<機能名>、fix-<修正内容>等）
  - **mainブランチでの直接作業は絶対禁止**: いかなる変更もmainブランチに直接コミットしない
- 以下を必ず作業終了時に実行してください。
  1. 作業内容をコミット
  2. リモートブランチにpush (`git push -u origin <ブランチ名>`)
  3. PR作成 (MCPでPR作成) 
  - @ai-rules/COMMIT_AND_PR_GUIDELINES.mdにガイドラインを記述しています。上記の作業時には必ず確認して必ず内容に従って作業を行ってください。

## 修正の際の注意点
- 修正を行う際には必ず以下のことに順守してください
  - 該当修正によって他の処理に問題がないか慎重に確認を行って作業を行ってください。
  - 他の動作に関しても修正が必要な場合は既存の期待値の動作が正常に起動するように修正してください。

## コミット前に確認すること（必ず実施）
- コミット前には必ず動作確認を行って動作が問題ないかを確認してください
  - 動作確認中にエラーが発見された際はタスクを更新してください
  - コミットする際はエラーがない状態で行ってください

## 開発時の注意点
- Tailwind CSSを優先して使用し、重複スタイルは避けること
- バックエンドAPIはFastAPIで定義し、リクエスト/レスポンススキーマにはPydanticモデルを使うこと
- .envファイル内のキーはUPPER_SNAKE_CASEで記述し、値にクォートは付けないこと

## ファイル作成時の注意点（ファイル作成時必ず確認）
- ファイル作成時に、そのファイルがGithubに挙げられるべきではないと判断した場合には、必ず.gitignoreに指定してください。

## ポート競合時の対処法
すでにポートが使用されている場合（例: 3000番や8000番など）、起動に失敗することがあります。
その場合は該当ポートを使用している場合は、そのポートを使用してください。
別のPJにて使用されている場合は、そのプロセスを特定し、killすることで使用してください。

```bash
# 例: ポート8000が使用中の場合
lsof -i :8000
kill -9 <PID>
```

## 動作確認・テスト時の必須確認事項（コミット前に必ず実施）
- テスト・動作確認の際はplaywrightのMCPツールを使用して動作確認を行ってください。
- テスト・動作確認は修正を行った際は必ず行ってください。
- E2Eテストとしてユーザ目線での動作が問題ないかしっかりと確認してください。

開発・テスト時は以下のユーザー情報を使用してください：
- メールアドレス: [テスト用メールアドレス]
- パスワード: [テスト用パスワード]
- ユーザー名: [テスト用ユーザー名]
- ユーザーID: [テスト用ユーザーID]

## AWS/Terraform コスト管理ガイドライン

### 月額コスト制限
- **絶対上限**: 月額3,000円以下を厳守
- **アラート設定**: 2,500円到達時にアラート発動
- **自動停止**: 2,800円到達時に非本番環境のリソース自動停止

### コスト効率化戦略
1. **インスタンスサイズ**: 最小限（t3.micro, t3.small優先）
2. **スケジューリング**: 開発環境は営業時間外自動停止
3. **リソース監視**: 未使用リソースの定期削除
4. **ストレージ最適化**: 不要なスナップショット・ログの自動削除

### Terraform設定例
```hcl
# コスト管理タグを全リソースに適用
resource "aws_default_tags" {
  tags = {
    Environment = "development"
    Project     = "ai-coding-project"
    CostCenter  = "development"
    AutoShutdown = "enabled"
  }
}

# 開発環境の自動停止設定
resource "aws_instance" "web" {
  instance_type = "t3.micro"  # コスト重視
  
  tags = {
    Schedule = "stop-evenings-weekends"
  }
}
```

## 社内展開時のカスタマイズ項目

### プロジェクト固有設定（要変更）
```markdown
## Repository 設定
- **リポジトリ名**: [各プロジェクトのリポジトリ名]
- **MCP GitHub API**: 常に `[リポジトリ名]` リポジトリを使用
- **Git remote**: [プロジェクト固有のリモートURL]

## テスト用ユーザー情報
- メールアドレス: [プロジェクト固有のテスト用メール]
- パスワード: [プロジェクト固有のテスト用パスワード]
- ユーザー名: [プロジェクト固有のテスト用ユーザー名]
- ユーザーID: [プロジェクト固有のテスト用ユーザーID]
```

### AI運用ルール追加要素
各プロジェクトで以下を追加検討：
1. **プロジェクト固有の命名規則**
2. **使用する外部APIの制限**
3. **セキュリティ要件**
4. **デプロイメント戦略**
5. **監視・ログ設定**

